<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>Aliz's Bookmarklet</title>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #f9f9fb; max-width: 600px; margin: auto; }
    h1 { color: #2574A9; }
    .bookmarklet {
      display: inline-block;
      padding: 0.8em 1.6em;
      background: #448aff;
      color: #fff;
      border-radius: 8px;
      font-size: 1.2em;
      text-decoration: none;
      cursor: grab;
      box-shadow: 0 2px 12px #448aff44;
      margin: 1.5em 0 0.5em 0;
    }
    .bookmarklet:hover { background: #2962ff; }
    .instructions {
      background: #fffbe0;
      border-left: 5px solid #ffd700;
      padding: 1em 1.5em;
      border-radius: 8px;
      color: #444;
      margin-bottom: 2em;
    }
    .label {
      margin-top: 1em;
      font-size: 1em;
      color: #2574A9;
      font-weight: bold;
      display: block;
    }
  </style>
</head>
<body>
  <h1>Aliz's Bookmarklet</h1>

  <div class="instructions">
    <b>使用說明：</b><br>
    1. 請將下方任一藍色按鈕<strong>拖曳到你的瀏覽器書籤列</strong>，即可安裝。<br>
    2. 之後瀏覽任何頁面，只要點這個書籤，即可使用。<br>
  </div>

  <span class="label">🔍 多功能搜尋 </span><br>
  <a class="bookmarklet" href="javascript:(function(){const nearbyMap={"中環":["中環","金鐘","上環","西營盤","半山","蘭桂坊"],"金鐘":["金鐘","中環","灣仔","金鐘道"],"灣仔":["灣仔","銅鑼灣","金鐘","跑馬地","大坑"],"銅鑼灣":["銅鑼灣","灣仔","天后","跑馬地","大坑"],"天后":["天后","銅鑼灣","北角"],"北角":["北角","炮台山","天后","鰂魚涌"],"炮台山":["炮台山","北角","鰂魚涌"],"鰂魚涌":["鰂魚涌","太古城","西灣河","北角"],"太古城":["太古城","鰂魚涌","西灣河"],"西灣河":["西灣河","筲箕灣","太古城"],"筲箕灣":["筲箕灣","西灣河","柴灣","杏花邨"],"柴灣":["柴灣","筲箕灣","杏花邨","小西灣"],"杏花邨":["杏花邨","小西灣","筲箕灣","柴灣"],"小西灣":["小西灣","杏花邨","柴灣"],"薄扶林":["薄扶林","數碼港","鋼綫灣"],"數碼港":["數碼港","薄扶林"],"鋼綫灣":["鋼綫灣","薄扶林"],"香港仔":["香港仔","鴨脷洲","田灣"],"鴨脷洲":["鴨脷洲","香港仔","利東","海怡半島"],"田灣":["田灣","香港仔"],"黃竹坑":["黃竹坑","海怡半島","利東"],"海怡半島":["海怡半島","鴨脷洲","黃竹坑","利東"],"利東":["利東","鴨脷洲","黃竹坑","海怡半島"],"深水灣":["深水灣","淺水灣","黃竹坑"],"淺水灣":["淺水灣","深水灣","赤柱"],"赤柱":["赤柱","淺水灣","石澳","大潭"],"大潭":["大潭","赤柱","石澳"],"石澳":["石澳","赤柱","大潭"],"石排灣":["石排灣","華富","香港仔"],"華富":["華富","石排灣","薄扶林"],"跑馬地":["跑馬地","銅鑼灣","大坑","灣仔"],"大坑":["大坑","跑馬地","銅鑼灣","灣仔"],"九龍城":["九龍城","九龍仔","馬頭圍","土瓜灣","紅磡","何文田","黃埔"],"九龍塘":["九龍塘","又一村","大窩坪","石硤尾"],"牛頭角":["牛頭角","九龍灣","觀塘"],"九龍灣":["九龍灣","牛頭角","觀塘"],"觀塘":["觀塘","牛頭角","九龍灣","藍田"],"藍田":["藍田","油塘","觀塘"],"油塘":["油塘","藍田","鯉魚門"],"鯉魚門":["鯉魚門","油塘"],"黃大仙":["黃大仙","慈雲山","竹園","鑽石山","斧山"],"鑽石山":["鑽石山","牛池灣","黃大仙","慈雲山"],"牛池灣":["牛池灣","鑽石山","黃大仙"],"樂富":["樂富","橫頭磡","黃大仙"],"長沙灣":["長沙灣","深水埗","荔枝角"],"深水埗":["深水埗","長沙灣","荔枝角","石硤尾"],"荔枝角":["荔枝角","長沙灣","美孚"],"美孚":["美孚","荔枝角","南昌"],"南昌":["南昌","美孚"],"旺角":["旺角","油麻地","太子","佐敦","大角咀"],"油麻地":["油麻地","旺角","佐敦"],"佐敦":["佐敦","油麻地","尖沙咀"],"尖沙咀":["尖沙咀","佐敦","柯士甸"],"柯士甸":["柯士甸","尖沙咀","佐敦"],"太子":["太子","旺角","大角咀"],"大角咀":["大角咀","旺角","奧運"],"奧運":["奧運","大角咀","旺角"],"屯門":["屯門","兆康","新墟","蝴蝶灣","龍門","洪水橋"],"兆康":["兆康","屯門","洪水橋"],"洪水橋":["洪水橋","兆康","屯門","元朗"],"元朗":["元朗","天水圍","洪水橋","錦上路","朗屏"],"天水圍":["天水圍","元朗","流浮山"],"流浮山":["流浮山","天水圍","元朗"],"錦上路":["錦上路","元朗","朗屏"],"朗屏":["朗屏","元朗","錦上路"],"荃灣":["荃灣","葵涌","青衣","梨木樹"],"葵涌":["葵涌","青衣","石籬","荃灣"],"青衣":["青衣","葵涌","荃灣"],"石籬":["石籬","葵涌"],"葵盛":["葵盛","葵涌"],"馬鞍山":["馬鞍山","烏溪沙","馬料水","西貢","沙田"],"烏溪沙":["烏溪沙","馬鞍山","馬料水"],"馬料水":["馬料水","烏溪沙","馬鞍山","沙田"],"沙田":["沙田","大圍","火炭","馬鞍山","馬料水","小瀝源","石門","第一城","恆安","沙田圍","車公廟","顯徑"],"大圍":["大圍","沙田","火炭","車公廟"],"火炭":["火炭","大圍","沙田"],"小瀝源":["小瀝源","沙田"],"石門":["石門","沙田"],"第一城":["第一城","沙田","恆安"],"恆安":["恆安","第一城","沙田"],"沙田圍":["沙田圍","沙田"],"車公廟":["車公廟","沙田","大圍"],"顯徑":["顯徑","沙田"],"大埔":["大埔","太和"],"太和":["太和","大埔"],"上水":["上水","粉嶺"],"粉嶺":["粉嶺","上水"],"沙頭角":["沙頭角","上水"],"西貢":["西貢","清水灣","將軍澳","調景嶺","馬鞍山"],"調景嶺":["調景嶺","將軍澳","西貢"],"將軍澳":["將軍澳","調景嶺","坑口","寶琳","康城","西貢"],"坑口":["坑口","將軍澳","寶琳"],"寶琳":["寶琳","將軍澳","坑口"],"康城":["康城","將軍澳"],"東涌":["東涌","大嶼山"],"大嶼山":["大嶼山","東涌"],"愉景灣":["愉景灣","坪洲"],"坪洲":["坪洲","愉景灣"],"長洲":["長洲"],"南丫島":["南丫島"],"澳門大堂區":["澳門大堂區","澳門新馬路","澳門皇朝"],"澳門新馬路":["澳門新馬路","澳門大堂區"],"澳門皇朝":["澳門皇朝","澳門大堂區"]};function clearHighlight(){document.querySelectorAll('.gpt-num-highlight,.gpt-area-highlight,.gpt-multikey-highlight,.gpt-multi-highlight').forEach(e=>{if(e.classList.contains('gpt-num-highlight')||e.classList.contains('gpt-area-highlight')||e.classList.contains('gpt-multikey-highlight')){let parent=e.parentNode;parent.replaceChild(document.createTextNode(e.textContent),e);parent.normalize()}else{e.style.background='';e.style.outline='';e.classList.remove('gpt-multi-highlight')}});let oldNav=document.getElementById('gpt-nav-ui');if(oldNav)oldNav.remove()}clearHighlight();var mode=prompt('💩 Welcome to Aliz Search 💩\n請輸入數字選擇搜尋模式：\n1 = 學費範圍 💰\n2 = 多組關鍵字 🔍\n3 = 鄰近地區 📍\n4 = 進階複合搜尋（可多條件同時篩選）✨\n其它 = 關閉 ❌');if(!["1","2","3","4"].includes(mode))return;function getTextNodes(node){var nodes=[];if(node.nodeType===3){nodes.push(node)}else if(node.nodeType===1&&node.childNodes&&!/^(script|style|textarea|input)$/i.test(node.tagName)){for(var i=0;i<node.childNodes.length;i++)nodes=nodes.concat(getTextNodes(node.childNodes[i]))}return nodes}var textNodes=getTextNodes(document.body);function showNav(highlights,infoText){if(!highlights.length){alert("找不到符合的結果！");return}let idx=0;function scrollToHighlight(i){highlights.forEach(h=>h.style.outline="");highlights[i].scrollIntoView({behavior:"smooth",block:"center"});highlights[i].style.outline="2.5px solid orange"}scrollToHighlight(idx);let navDiv=document.createElement("div");navDiv.id="gpt-nav-ui";navDiv.style.position="fixed";navDiv.style.top="30px";navDiv.style.right="30px";navDiv.style.background="rgba(255,255,200,0.97)";navDiv.style.border="1px solid #aaa";navDiv.style.zIndex=999999;navDiv.style.padding="8px 12px";navDiv.style.borderRadius="6px";navDiv.style.boxShadow="0 2px 8px #ccc";navDiv.style.fontFamily="sans-serif";navDiv.style.fontSize="15px";navDiv.innerHTML=%60<button id="gpt-prev">上一個</button><span id="gpt-counter">${idx+1} / ${highlights.length}</span><button id="gpt-next">下一個</button><button id="gpt-close" style="margin-left:10px;">關閉</button><span style="margin-left:10px;font-size:90%;color:#444;">${infoText}</span>%60;document.body.appendChild(navDiv);document.getElementById("gpt-prev").onclick=function(){idx=(idx-1+highlights.length)%highlights.length;scrollToHighlight(idx);document.getElementById("gpt-counter").textContent=%60${idx+1} / ${highlights.length}%60};document.getElementById("gpt-next").onclick=function(){idx=(idx+1)%highlights.length;scrollToHighlight(idx);document.getElementById("gpt-counter").textContent=%60${idx+1} / ${highlights.length}%60};document.getElementById("gpt-close").onclick=function(){navDiv.remove();highlights.forEach(h=>{if(h.classList.contains("gpt-num-highlight")||h.classList.contains("gpt-area-highlight")||h.classList.contains("gpt-multikey-highlight")){let parent=h.parentNode;parent.replaceChild(document.createTextNode(h.textContent),h);parent.normalize()}else{h.style.background="";h.style.outline="";h.classList.remove("gpt-multi-highlight")}})}}if(mode==="1"){var min=parseFloat(prompt("請輸入最低學費（不建議搜尋個位數）：","100"));var max=parseFloat(prompt("請輸入最高學費：","300"));if(isNaN(min)||isNaN(max)||min>max)return alert("輸入無效");var numberRegex=/\d+(\.\d+)?/g;let highlights=[];textNodes.forEach(function(node){var text=node.nodeValue,match,lastIndex=0,parent=node.parentNode,frag=document.createDocumentFragment();numberRegex.lastIndex=0;var found=false;while((match=numberRegex.exec(text))!==null){var num=parseFloat(match[0]);if(num>=min&&num<=max){found=true;frag.appendChild(document.createTextNode(text.slice(lastIndex,match.index)));var span=document.createElement("span");span.textContent=match[0];span.className="gpt-num-highlight";span.style.background="yellow";span.style.color="black";span.style.fontWeight="bold";frag.appendChild(span);highlights.push(span);lastIndex=match.index+match[0].length}}if(found){frag.appendChild(document.createTextNode(text.slice(lastIndex)));parent.replaceChild(frag,node)}});showNav(highlights,%60數值範圍：${min} ~ ${max}%60)}if(mode==="2"){var input=prompt("請輸入關鍵字（可多個，用逗號或空格分隔）：\n例如：幼稚園,幼兒");if(!input)return;var keywords=input.split(/[,，\s]+/).map(function(s){return s.trim()}).filter(Boolean);if(!keywords.length)return;var regex=new RegExp(keywords.map(k=>k.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\\\$1")).join("|"),"g");let highlights=[];textNodes.forEach(function(node){var text=node.nodeValue,match,lastIndex=0,parent=node.parentNode,frag=document.createDocumentFragment();regex.lastIndex=0;var found=false;while((match=regex.exec(text))!==null){found=true;frag.appendChild(document.createTextNode(text.slice(lastIndex,match.index)));var span=document.createElement("span");span.textContent=match[0];span.className="gpt-multikey-highlight";span.style.background="gold";span.style.color="black";span.style.fontWeight="bold";frag.appendChild(span);highlights.push(span);lastIndex=match.index+match[0].length}if(found){frag.appendChild(document.createTextNode(text.slice(lastIndex)));parent.replaceChild(frag,node)}});showNav(highlights,"多關鍵字："+keywords.join(", "))}if(mode==="3"){var area=prompt("請輸入一個地區名稱（如：馬鞍山 / 新蒲崗 / 西灣河...）：");if(!area)return;area=area.trim();var keywords=[],foundKey=null;for(var key in nearbyMap){if(key===area){keywords=nearbyMap[key];foundKey=key;break}}if(!foundKey){for(var key in nearbyMap){if(nearbyMap[key].includes(area)){keywords=nearbyMap[key];foundKey=key;break}}}if(!foundKey){alert("抱歉，未有此地區的鄰近地區資料，可聯絡開發者擴充！");return}var regex=new RegExp(keywords.map(function(k){return k.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\\\$1")}).join("|"),"g");let highlights=[];textNodes.forEach(function(node){var text=node.nodeValue,match,lastIndex=0,parent=node.parentNode,frag=document.createDocumentFragment();regex.lastIndex=0;var found=false;while((match=regex.exec(text))!==null){found=true;frag.appendChild(document.createTextNode(text.slice(lastIndex,match.index)));var span=document.createElement("span");span.textContent=match[0];span.className="gpt-area-highlight";span.style.background="lime";span.style.color="black";span.style.fontWeight="bold";frag.appendChild(span);highlights.push(span);lastIndex=match.index+match[0].length}if(found){frag.appendChild(document.createTextNode(text.slice(lastIndex)));parent.replaceChild(frag,node)}});showNav(highlights,%60地區：「${area}」及鄰近 (${keywords.join("、")})%60)}if(mode==="4"){const searchExamples=[{label:"最低學費（例如：200，留空=不限）",example:"例：200",key:"minFee",placeholder:""},{label:"最高學費（例如：400，留空=不限）",example:"例：400",key:"maxFee",placeholder:""},{label:"性別（例如：男 或 女，留空=不限）",example:"例：女",key:"gender",placeholder:""},{label:"關鍵字（多個用逗號、空格或頓號分隔，留空=不限）",example:"例：英文,幼兒",key:"keywords",placeholder:""},{label:"地區（可只填地區名或地鐵站名，留空=不限）",example:"例：沙田",key:"area",placeholder:""}];let values={};for(let i=0;i<searchExamples.length;i++){let filled="";if(i>0){filled="\n\n已填資料：\n"+searchExamples.slice(0,i).map(e=>{let val=values[e.key];return e.label.replace(/（[^）]*）/,"")+"："+(val?val:"（未填）")}).join("\n")}let msg=%60【${searchExamples[i].label}】\n${searchExamples[i].example}\n\n（全部可留空）${filled}%60;let v=prompt(msg,searchExamples[i].placeholder||"");if(v===null)return;values[searchExamples[i].key]=v.trim()}let min=values["minFee"]?parseFloat(values["minFee"]):null;let max=values["maxFee"]?parseFloat(values["maxFee"]):null;let gender=values["gender"]?values["gender"].replace(/[^男女]/g,""):"";let keywords=values["keywords"]?values["keywords"].split(/[,，\s]+/).map(s=>s.trim()).filter(Boolean):[];let area=values["area"]?values["area"].trim():"";let areaList=[];if(area){areaList=[area];for(let key in nearbyMap){if(key===area){areaList=nearbyMap[key];break}if(nearbyMap[key].includes(area)){areaList=nearbyMap[key];break}}}document.querySelectorAll(".gpt-multi-highlight").forEach(e=>{e.style.background="";e.classList.remove("gpt-multi-highlight");e.style.outline=""});let tutors=Array.from(document.querySelectorAll("a.sentence[data-tutor-id]"));let results=[];tutors.forEach(function(card){let feeText=card.querySelector(".tutor-response-fee")?card.querySelector(".tutor-response-fee").textContent:"";let fee=feeText?parseFloat(feeText.replace(/[^\d.]/g,"")):null;let feeOK=true;if(min!==null||max!==null){feeOK=false;if(fee!==null&&!isNaN(fee)){feeOK=(!min||fee>=min)&&(!max||fee<=max)}}let genderText=card.querySelector(".gender")?card.querySelector(".gender").textContent.trim():"";let genderOK=gender?(genderText===gender):true;let mainText=card.innerText||"";let keywordOK=keywords.length?keywords.some(k=>mainText.includes(k)):true;let areaText="";let areaLabel=card.querySelector('label[style*="font-weight:bold"]');if(areaLabel)areaText=areaLabel.textContent.trim();let areaOK=areaList.length?areaList.some(a=>areaText.includes(a)||mainText.includes(a)):true;if(feeOK&&genderOK&&keywordOK&&areaOK){card.classList.add("gpt-multi-highlight");card.style.background="linear-gradient(90deg,#fffd96,#a2ffd6)";results.push(card)}});if(!results.length){alert("找不到符合的導師");return}let idx=0;function scrollTo(i){results.forEach(x=>x.style.outline="");results[i].scrollIntoView({behavior:"smooth",block:"center"});results[i].style.outline="3px solid #3af"}scrollTo(idx);let nav=document.createElement("div");nav.id="gpt-nav-ui";nav.style.position="fixed";nav.style.top="35px";nav.style.right="35px";nav.style.background="#fff8cc";nav.style.border="1px solid #aaa";nav.style.zIndex=999999;nav.style.padding="8px 16px";nav.style.borderRadius="7px";nav.style.boxShadow="0 2px 8px #bbb";nav.style.fontFamily="sans-serif";nav.style.fontSize="16px";function condText(){let arr=[];if(min||min===0)arr.push(%60${min}元以上%60);if(max||max===0)arr.push(%60${max}元以下%60);if(gender)arr.push(gender);if(keywords.length)arr.push(keywords.join("、"));if(areaList.length)arr.push(areaList.join("、"));return arr.join("，")}nav.innerHTML=%60<button id="gpt-prev">上一個</button><span id="gpt-count">${idx+1} / ${results.length}</span><button id="gpt-next">下一個</button><button id="gpt-close" style="margin-left:12px;">關閉</button><span style="color:#444;font-size:90%;margin-left:10px;">${condText()}</span>%60;document.body.appendChild(nav);document.getElementById("gpt-prev").onclick=function(){idx=(idx-1+results.length)%results.length;scrollTo(idx);document.getElementById("gpt-count").textContent=%60${idx+1} / ${results.length}%60};document.getElementById("gpt-next").onclick=function(){idx=(idx+1)%results.length;scrollTo(idx);document.getElementById("gpt-count").textContent=%60${idx+1} / ${results.length}%60};document.getElementById("gpt-close").onclick=function(){nav.remove();results.forEach(x=>{x.style.background="";x.style.outline="";x.classList.remove("gpt-multi-highlight")})}}})();">🔍 拖曳這個到書籤列後自行改名</a>

  <br><br>
  <span class="label">🤖 SleekFlow 自動回覆 (測試階段)</span><br>
  <a class="bookmarklet" href="javascript:(function()%7B(function()%20%7B%0A%20%20%2F%2F%201.%20%E8%A7%B8%E7%99%BC%E6%A2%9D%E4%BB%B6%E8%A8%AD%E8%A8%88%0A%20%20const%20triggers%20%3D%20%5B%0A%20%20%20%20%7B%0A%20%20%20%20%20%20groups%3A%20%5B%0A%20%20%20%20%20%20%20%20%7B%20all%3A%20%5B%22%E9%8F%88%E7%B5%90%E7%9A%84%E5%B0%8E%E5%B8%AB%22%2C%20%22%E5%A6%82%E6%9C%89%E5%90%88%E9%81%A9%22%5D%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%20all%3A%20%5B%22%E5%90%8D%E5%96%AE%E4%B8%AD%22%2C%20%22%E5%90%88%E9%81%A9%E7%9A%84%E5%B0%8E%E5%B8%AB%22%5D%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%20all%3A%20%5B%22%E4%B8%8D%E5%90%88%E9%81%A9%22%2C%20%22%E6%9C%89%E4%BB%80%E9%BA%BC%E8%A6%81%E6%B1%82%22%5D%20%7D%0A%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20reply%3A%20%22%E8%AB%8B%E5%95%8F%E4%BB%8D%E9%9C%80%E8%A6%81%E5%B0%8B%E6%89%BE%E8%A3%9C%E7%BF%92%E5%B0%8E%E5%B8%AB%E5%97%8E%F0%9F%98%8A%EF%BC%9F%E8%A6%8B%E6%9C%AA%E6%94%B6%E5%88%B0%E4%BD%A0%E7%9A%84%E5%9B%9E%E8%A6%86%EF%BC%8C%E8%AB%8B%E5%95%8F%E6%98%AF%E6%9C%89%E4%BB%80%E9%BA%BC%E7%96%91%E6%83%91%E5%97%8E%EF%BC%9F%E6%9C%83%E6%96%B9%E4%BE%BF%E5%9B%9E%E8%A6%86%E4%B8%80%E4%B8%8B%E5%97%8E%F0%9F%99%8F%F0%9F%8F%BB%EF%BC%9F%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20%7B%0A%20%20%20%20%20%20all%3A%20%5B%22%E5%80%8B%E6%A1%88%E7%B7%A8%E8%99%9F%22%2C%20%22%E4%BD%A0%E5%98%85%E5%80%8B%E6%A1%88%22%5D%2C%0A%20%20%20%20%20%20reply%3A%20%22%E8%AB%8B%E5%95%8F%E9%8F%88%E7%B5%90%E7%9A%84%E5%B0%8E%E5%B8%AB%E5%90%88%E9%81%A9%E5%97%8E%F0%9F%98%8A%EF%BC%9F%E5%A6%82%E6%9C%89%E5%90%88%E9%81%A9%E7%9A%84%E8%A9%B1%E8%AB%8B%E7%9B%A1%E5%BF%AB%E9%80%9A%E7%9F%A5%E6%88%91%E5%80%91%E7%82%BA%E4%BD%A0%E5%AE%89%E6%8E%92%EF%BC%8C%E4%BB%A5%E5%85%8D%E5%B0%8E%E5%B8%AB%E7%B4%84%E6%BB%BF%F0%9F%98%8A%F0%9F%99%8F%F0%9F%8F%BB%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20%7B%0A%20%20%20%20%20%20all%3A%20%5B%22%E4%BD%A0%E6%9C%83%E8%80%83%E6%85%AE%E6%AD%A4%E5%B0%8E%E5%B8%AB%E5%97%8E%22%5D%2C%0A%20%20%20%20%20%20reply%3A%20%22%E8%AB%8B%E5%95%8F%E5%9C%96%E4%B8%AD%E7%9A%84%E5%B0%8E%E5%B8%AB%E5%90%88%E9%81%A9%E5%97%8E%F0%9F%98%8A%EF%BC%9F%E5%A6%82%E6%9C%89%E5%90%88%E9%81%A9%E7%9A%84%E8%A9%B1%E8%AB%8B%E7%9B%A1%E5%BF%AB%E9%80%9A%E7%9F%A5%E6%88%91%E5%80%91%E7%82%BA%E4%BD%A0%E5%AE%89%E6%8E%92%EF%BC%8C%E4%BB%A5%E5%85%8D%E5%B0%8E%E5%B8%AB%E7%B4%84%E6%BB%BF%F0%9F%98%8A%F0%9F%99%8F%F0%9F%8F%BB%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20%7B%0A%20%20%20%20%20%20groups%3A%20%5B%0A%20%20%20%20%20%20%20%20%7B%20all%3A%20%5B%22%E5%90%8D%E5%96%AE%22%2C%20%22%E6%9C%AA%E6%94%B6%E5%88%B0%E4%BD%A0%E7%9A%84%E5%9B%9E%E8%A6%86%22%5D%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%20all%3A%20%5B%22%E4%BB%8D%E9%9C%80%E8%A6%81%E5%B0%8B%E6%89%BE%E8%A3%9C%E7%BF%92%E5%B0%8E%E5%B8%AB%22%2C%20%22%E6%9C%AA%E6%94%B6%E5%88%B0%E4%BD%A0%E7%9A%84%E5%9B%9E%E8%A6%86%22%5D%20%7D%0A%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20reply%3A%20%22%E8%A6%8B%E4%BB%8D%E6%9C%AA%E6%94%B6%E5%88%B0%E4%BD%A0%E7%9A%84%E5%9B%9E%E8%A6%86%EF%BC%8C%E5%80%8B%E6%A1%88%E6%9C%83%E7%82%BA%E4%BD%A0%E5%85%88%E9%97%9C%E9%96%89%E3%80%82%E5%86%8D%E6%9C%89%E9%9C%80%E8%A6%81%E7%9A%84%E8%A9%B1%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%87%8D%E6%96%B0%E5%9C%A8%E7%B6%B2%E7%AB%99%E5%86%8D%E4%BD%9C%E7%94%B3%E8%AB%8B%EF%BC%8C%E8%AC%9D%E8%AC%9D%F0%9F%98%8A%F0%9F%99%8F%F0%9F%8F%BB%22%0A%20%20%20%20%7D%0A%20%20%5D%3B%0A%0A%20%20%2F%2F%202.%20%E5%8F%96%E5%BE%97%E6%89%80%E6%9C%89%E8%A8%8A%E6%81%AF%E7%AF%80%E9%BB%9E%0A%20%20let%20msgNodes%20%3D%20Array.from(document.querySelectorAll('span%5Bdata-testid%3D%22inbox-conversation-text-message%22%5D%20%3E%20span'))%3B%0A%20%20if%20(!msgNodes.length)%20%7B%0A%20%20%20%20alert(%22%E7%84%A1%E6%B3%95%E5%8F%96%E5%BE%97%E8%A8%8A%E6%81%AF%E5%85%A7%E5%AE%B9%EF%BC%8C%E8%AB%8B%E7%A2%BA%E8%AA%8D%E5%9C%A8%E5%B0%8D%E8%A9%B1%E7%95%AB%E9%9D%A2%EF%BC%81%22)%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%20%20let%20lastMsgNode%20%3D%20msgNodes%5BmsgNodes.length%20-%201%5D%3B%0A%20%20let%20lastMsg%20%3D%20lastMsgNode.innerText.trim()%3B%0A%0A%20%20%2F%2F%203.%20%E5%90%91%E4%B8%8A%E9%81%8D%E6%AD%B7%EF%BC%8C%E6%89%BE%E4%B8%8A%E4%B8%80%E5%80%8B%E6%97%A5%E6%9C%9F%E5%88%86%E9%9A%94%0A%20%20let%20dateText%20%3D%20null%3B%0A%20%20let%20node%20%3D%20lastMsgNode.parentElement%3B%0A%20%20while%20(node)%20%7B%0A%20%20%20%20%2F%2F%20%E6%9F%A5%E6%89%BE%E5%90%8C%E5%B1%A4%E7%9A%84%E4%B9%8B%E5%89%8D%E5%85%84%E5%BC%9F%E7%AF%80%E9%BB%9E%0A%20%20%20%20let%20prev%20%3D%20node.previousSibling%3B%0A%20%20%20%20while%20(prev)%20%7B%0A%20%20%20%20%20%20if%20(%0A%20%20%20%20%20%20%20%20prev.matches%20%26%26%0A%20%20%20%20%20%20%20%20prev.matches('button%5Bdata-sentry-element%3D%22StickyDateIndicatorButtonBase%22%5D')%0A%20%20%20%20%20%20)%20%7B%0A%20%20%20%20%20%20%20%20dateText%20%3D%20(prev.childNodes%5B0%5D%3F.textContent%20%7C%7C%20prev.textContent).trim()%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20prev%20%3D%20prev.previousSibling%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20(dateText)%20break%3B%0A%20%20%20%20node%20%3D%20node.parentElement%3B%0A%20%20%7D%0A%20%20if%20(!dateText)%20%7B%0A%20%20%20%20%2F%2F%20%E8%8B%A5%E9%82%84%E6%89%BE%E4%B8%8D%E5%88%B0%EF%BC%8C%E6%8A%93%E5%85%A8%E9%A0%81%E6%9C%80%E5%BE%8C%E4%B8%80%E5%80%8B%E6%97%A5%E6%9C%9F%E5%88%86%E9%9A%94%0A%20%20%20%20let%20dateBtns%20%3D%20Array.from(document.querySelectorAll('button%5Bdata-sentry-element%3D%22StickyDateIndicatorButtonBase%22%5D'))%3B%0A%20%20%20%20if%20(dateBtns.length)%20%7B%0A%20%20%20%20%20%20dateText%20%3D%20(dateBtns%5BdateBtns.length-1%5D.childNodes%5B0%5D%3F.textContent%20%7C%7C%20dateBtns%5BdateBtns.length-1%5D.textContent).trim()%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%204.%20%E5%88%86%E6%9E%90%E9%80%99%E5%80%8B%E6%97%A5%E6%9C%9F%0A%20%20let%20isToday%20%3D%20false%3B%0A%20%20if%20(dateText)%20%7B%0A%20%20%20%20if%20(%2F%5Etoday%24%2Fi.test(dateText))%20isToday%20%3D%20true%3B%0A%20%20%20%20%2F%2F%20%E4%BD%A0%E5%8F%AF%E5%9C%A8%E9%80%99%E8%A3%A1%E6%93%B4%E5%85%85%E4%B8%AD%E6%96%87%20Today%0A%20%20%7D%0A%0A%20%20if%20(isToday)%20%7B%0A%20%20%20%20alert(%22%E4%BB%8A%E5%A4%A9%E5%B7%B2%E7%B6%93%E6%9C%89%E9%81%8E%E6%BA%9D%E9%80%9A%EF%BC%8C%E4%B8%8D%E6%9C%83%E5%86%8D%E8%87%AA%E5%8B%95%E8%BC%B8%E5%85%A5%E8%A8%8A%E6%81%AF%E3%80%82%22)%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%205.%20%E5%88%A4%E6%96%B7%E8%A6%81%E5%9B%9E%E8%A6%86%E7%9A%84%E5%85%A7%E5%AE%B9%0A%20%20function%20getReply(msg)%20%7B%0A%20%20%20%20for%20(let%20t%20of%20triggers)%20%7B%0A%20%20%20%20%20%20if%20(t.groups)%20%7B%0A%20%20%20%20%20%20%20%20for%20(let%20g%20of%20t.groups)%20%7B%0A%20%20%20%20%20%20%20%20%20%20let%20allPass%20%3D%20!g.all%20%7C%7C%20g.all.every(k%20%3D%3E%20msg.includes(k))%3B%0A%20%20%20%20%20%20%20%20%20%20let%20anyPass%20%3D%20!g.any%20%7C%7C%20g.any.some(k%20%3D%3E%20msg.includes(k))%3B%0A%20%20%20%20%20%20%20%20%20%20if%20(allPass%20%26%26%20anyPass)%20return%20t.reply%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20let%20allPass%20%3D%20!t.all%20%7C%7C%20t.all.every(k%20%3D%3E%20msg.includes(k))%3B%0A%20%20%20%20%20%20%20%20let%20anyPass%20%3D%20!t.any%20%7C%7C%20t.any.some(k%20%3D%3E%20msg.includes(k))%3B%0A%20%20%20%20%20%20%20%20if%20(allPass%20%26%26%20anyPass)%20return%20t.reply%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20%22%22%3B%0A%20%20%7D%0A%20%20let%20reply%20%3D%20getReply(lastMsg)%3B%0A%20%20if%20(!reply)%20%7B%0A%20%20%20%20alert(%22%E6%9C%80%E5%BE%8C%E4%B8%80%E5%89%87%E8%A8%8A%E6%81%AF%E4%B8%8D%E7%AC%A6%E5%90%88%E4%BB%BB%E4%BD%95%E5%9B%9E%E8%A6%86%E6%A2%9D%E4%BB%B6%EF%BC%8C%E6%9C%AA%E8%87%AA%E5%8B%95%E8%BC%B8%E5%85%A5%E3%80%82%22)%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%206.%20%E5%A1%AB%E5%85%A5%E5%9B%9E%E8%A6%86%E5%88%B0%E8%BC%B8%E5%85%A5%E6%A1%86%EF%BC%88%E5%84%AA%E5%85%88%E7%94%A8%E7%9B%B4%E6%8E%A5%E8%BC%B8%E5%85%A5%EF%BC%89%0A%20%20let%20inputBox%20%3D%20document.querySelector('textarea%5Bdata-testid%3D%22inbox-conversation-input-textbox%22%5D')%3B%0A%20%20if%20(inputBox%20%26%26%20!inputBox.disabled%20%26%26%20!inputBox.readOnly)%20%7B%0A%20%20%20%20setReactTextareaValue(inputBox%2C%20reply)%3B%0A%20%20%20%20inputBox.focus()%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%207.%20%E9%80%B2%E5%85%A5%E7%AF%84%E6%9C%AC%E6%B5%81%E7%A8%8B%0A%20%20function%20findTemplateMainBtn()%20%7B%0A%20%20%20%20let%20btns%20%3D%20document.querySelectorAll('button')%3B%0A%20%20%20%20for%20(let%20btn%20of%20btns)%20%7B%0A%20%20%20%20%20%20if%20(btn.textContent%20%26%26%20btn.textContent.trim().toLowerCase()%20%3D%3D%3D%20%22choose%20template%22)%20%7B%0A%20%20%20%20%20%20%20%20return%20btn%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%20%20let%20templateBtn%20%3D%20findTemplateMainBtn()%3B%0A%20%20if%20(!templateBtn)%20%7B%0A%20%20%20%20alert(%22%E6%89%BE%E4%B8%8D%E5%88%B0%E3%80%8EChoose%20template%E3%80%8F%E6%8C%89%E9%88%95%EF%BC%81%22)%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%20%20templateBtn.click()%3B%0A%0A%20%20function%20waitForTemplateCardAndClick(maxTry%20%3D%2050)%20%7B%0A%20%20%20%20let%20card%20%3D%20document.querySelector('button%5Bdata-testid%3D%22whatsapp-template-card-greetings_hello_1-en%22%5D')%3B%0A%20%20%20%20if%20(card)%20%7B%0A%20%20%20%20%20%20card.click()%3B%0A%20%20%20%20%20%20setTimeout(clickConfirmChooseTemplate%2C%2050)%3B%0A%20%20%20%20%7D%20else%20if%20(maxTry%20%3E%200)%20%7B%0A%20%20%20%20%20%20setTimeout(()%20%3D%3E%20waitForTemplateCardAndClick(maxTry%20-%201)%2C%2050)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20alert(%22%E6%89%BE%E4%B8%8D%E5%88%B0%E7%9B%AE%E6%A8%99%E7%AF%84%E6%9C%AC%E9%81%B8%E9%A0%85%EF%BC%81%22)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20clickConfirmChooseTemplate(maxTry%20%3D%2050)%20%7B%0A%20%20%20%20let%20confirmBtn%20%3D%20document.querySelector('button%5Bdata-testid%3D%22broadcasts-template-dialog-choose-template-button%22%5D')%3B%0A%20%20%20%20if%20(confirmBtn)%20%7B%0A%20%20%20%20%20%20confirmBtn.click()%3B%0A%20%20%20%20%20%20setTimeout(fillTemplateInput%2C%2050)%3B%0A%20%20%20%20%7D%20else%20if%20(maxTry%20%3E%200)%20%7B%0A%20%20%20%20%20%20setTimeout(()%20%3D%3E%20clickConfirmChooseTemplate(maxTry%20-%201)%2C%2050)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20alert(%22%E6%89%BE%E4%B8%8D%E5%88%B0%E7%A2%BA%E8%AA%8D%E9%81%B8%E6%93%87%E7%AF%84%E6%9C%AC%E7%9A%84%E6%8C%89%E9%88%95%EF%BC%81%22)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20fillTemplateInput(maxTry%20%3D%2050)%20%7B%0A%20%20%20%20let%20span%20%3D%20document.querySelector('span%5Bdata-testid%3D%22inbox-insert-template-variable-body%5C%5C.0%5C%5C.text%22%5D')%3B%0A%20%20%20%20if%20(span%20%26%26%20span.getAttribute(%22contenteditable%22)%20%3D%3D%3D%20%22true%22)%20%7B%0A%20%20%20%20%20%20span.focus()%3B%0A%20%20%20%20%20%20document.execCommand(%22selectAll%22%2C%20false%2C%20null)%3B%0A%20%20%20%20%20%20document.execCommand(%22delete%22%2C%20false%2C%20null)%3B%0A%20%20%20%20%20%20insertTextToContentEditable(span%2C%20reply)%3B%0A%20%20%20%20%7D%20else%20if%20(maxTry%20%3E%200)%20%7B%0A%20%20%20%20%20%20setTimeout(()%20%3D%3E%20fillTemplateInput(maxTry%20-%201)%2C%2050)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20alert(%22%E6%89%BE%E4%B8%8D%E5%88%B0%E7%AF%84%E6%9C%AC%E8%BC%B8%E5%85%A5%E6%A1%86%EF%BC%81%22)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20setTimeout(waitForTemplateCardAndClick%2C%2050)%3B%0A%0A%20%20%2F%2F%20%E5%B7%A5%E5%85%B7%E5%87%BD%E5%BC%8F%0A%20%20function%20setReactTextareaValue(textarea%2C%20value)%20%7B%0A%20%20%20%20const%20setter%20%3D%20Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype%2C%20%22value%22).set%3B%0A%20%20%20%20setter.call(textarea%2C%20value)%3B%0A%20%20%20%20textarea.dispatchEvent(new%20Event(%22input%22%2C%20%7B%20bubbles%3A%20true%20%7D))%3B%0A%20%20%7D%0A%20%20function%20insertTextToContentEditable(el%2C%20text)%20%7B%0A%20%20%20%20el.innerText%20%3D%20text%3B%0A%20%20%20%20el.dispatchEvent(new%20InputEvent(%22input%22%2C%20%7B%20bubbles%3A%20true%20%7D))%3B%0A%20%20%7D%0A%7D)()%3B%7D)()%3B">🤖 拖曳這個到書籤列後自行改名</a>
</body>
</html>
