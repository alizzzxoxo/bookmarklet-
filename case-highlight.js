javascript:(function(){var a={"中文":"C","英文":"E","數學":"M","功課":"HW","全科":"A","物理":"P","化學":"Chem","生物":"Bio","地理":"G","經營":"Ec","會計":"Ac","M1":"M1","M2":"M2","資訊及通訊科技":"ICT","西史":"WHis","中史":"CHis","普通話":"PTH","綜合科學":"IS","廣東話":"CT","旅遊與款待":"旅款","升學面試課":"面試","中國文學":"CL","英國文學":"EL","日語":"JP"};var b=Array.from(document.querySelectorAll("table tr")).filter(function(e){return e.querySelector("a[href]")});var c=b.map(function(e){var f=e.querySelectorAll("td");var g=e.querySelector("a[href]")?.textContent.trim();var h=f[6]?.textContent.trim()||"";var i=f[8]?.textContent.trim().replace(/\(\d+\)$/,"").replace(/，/g,",").replace(/ /g,"")||"";return{caseId:g,row:e,tds:f,subject:h,phone:i}}).filter(function(e){return!!e.caseId});if(!c.length){alert("找不到任何case");return}var d=prompt("請輸入case ID");if(!d)return;var e=c.findIndex(function(e){return e.caseId==d});if(e===-1){alert("找不到case ID: "+d);return}var f="__case_highlight_style__";document.getElementById(f)?.remove();var g=document.createElement("style");g.id=f;g.innerHTML=".case-row-highlight-bookmarklet,.case-td-highlight-bookmarklet{background:#99CCFF!important;transition:background .4s,box-shadow .3s;}.case-td-highlight-bookmarklet{box-shadow:0 0 0 2px #99CCFF!important;position:relative!important;z-index:2!important;}";document.head.appendChild(g);function h(k,l){document.querySelectorAll(".case-row-highlight-bookmarklet").forEach(function(m){m.classList.remove("case-row-highlight-bookmarklet")});document.querySelectorAll(".case-td-highlight-bookmarklet").forEach(function(m){m.classList.remove("case-td-highlight-bookmarklet")});if(k)k.classList.add("case-row-highlight-bookmarklet");if(l)for(var m=0;m<l.length;m++)l[m].classList.add("case-td-highlight-bookmarklet"),l[0]?.parentElement.scrollIntoView({behavior:"smooth",block:"center"})}function i(k){e=k;var l=c[e],m=l.subject.split(/[,\s，]+/).map(function(n){return a[n.trim()]||n.trim()}).filter(Boolean),n="T"+l.caseId+(m.length?m.join("&"):""),o='<div style="font-size:18px;margin-bottom:10px;">CaseID: <b>'+l.caseId+"</b><br>科目: <b>"+l.subject+"</b><br>電話: <b>"+l.phone+'</b><br></div><button id="pre_case" style="margin-right:10px;">上一個</button><button id="next_case" style="margin-right:10px;">下一個</button><button id="copy_phone" style="margin-right:10px;">電話</button><button id="copy_casecode">個案編號</button><span style="float:right;cursor:pointer;font-size:16px;" id="close_popup">❌</span>';var p=document.createElement("div");p.id="case_popup_box";p.innerHTML=o;Object.assign(p.style,{position:"fixed",top:"16px",right:"16px",left:"auto",transform:"none",background:"#fff",border:"2px solid #888",padding:"24px",zIndex:99999,borderRadius:"12px",boxShadow:"0 6px 32px #0003",minWidth:"320px"});document.querySelectorAll("#case_popup_box").forEach(function(q){q.remove()});document.body.appendChild(p);h(l.row,l.tds);document.getElementById("pre_case").onclick=function(){if(e>0)i(e-1)};document.getElementById("next_case").onclick=function(){if(e<c.length-1)i(e+1)};document.getElementById("copy_phone").onclick=function(){j(l.phone)};document.getElementById("copy_casecode").onclick=function(){j(n)};document.getElementById("close_popup").onclick=function(){p.remove();h()}}function j(k){if(navigator.clipboard&&window.isSecureContext){navigator.clipboard.writeText(k)}else{var l=document.createElement("textarea");l.value=k;l.setAttribute("readonly","");l.style.position="absolute";l.style.left="-9999px";document.body.appendChild(l);l.select();try{document.execCommand("copy")}catch(m){prompt("請手動複製",k)}document.body.removeChild(l)}}i(e)})();
